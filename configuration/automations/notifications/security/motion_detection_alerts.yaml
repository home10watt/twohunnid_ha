- alias: 'Motion Detected: Anywhere'
  trigger:
  - entity_id: 
      - binary_sensor.motion_backyard_north
      - binary_sensor.backyard_patio_camera_motion
      - binary_sensor.motion_backyard_south
      - binary_sensor.motion_front_yard_south
      - binary_sensor.motion_front_driveway
      - binary_sensor.front_door_camera_motion_detected
    from: 'off'
    platform: state
    to: 'on'
  condition: []
  action:
  - data_template:
      message: >
        motion detected at the house!
        {%- for entity_id in states.group.all_motion_sensors.attributes.entity_id -%}
          {% set parts = entity_id.split('.') -%}
          {% if states(entity_id) == 'on' %} {{ states[parts[0]][parts[1]].name|replace('Motion - ','') }},{% endif %}
        {%- endfor %}
    service: notify.nick
  - condition: template
    value_template: "{{ 'camera_entity_id' in trigger.to_state.attributes }}"
  - service: script.turn_on
    entity_id: script.camera_snapshot
    data_template:
      variables:
        camera_entity_id: "{{ trigger.to_state.attributes.camera_entity_id }}"
